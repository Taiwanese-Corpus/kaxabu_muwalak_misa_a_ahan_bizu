version: '3.5'

services:
  nginx:
    build: 前端/
    networks:
      - nginx-bridge
    environment:
      VIRTUAL_HOST: ${VIRTUAL_HOST_TSIANTUAN:-kaxabu.ithuan.tw}
      LETSENCRYPT_HOST: ${VIRTUAL_HOST_TSIANTUAN:-kaxabu.ithuan.tw}
      LETSENCRYPT_EMAIL: "ithuan@ithuan.tw"
    restart: always
  gunicorn:
    build: 後端/
    networks:
      - nginx-bridge
    environment:
      AWS_S3_ENDPOINT_URL: ${AWS_S3_ENDPOINT_URL}
      AWS_ACCESS_KEY_ID: ${AWS_ACCESS_KEY_ID}
      AWS_SECRET_ACCESS_KEY: ${AWS_SECRET_ACCESS_KEY}
      VIRTUAL_HOST: ${VIRTUAL_HOST_AUTUAN:-dbkaxabu.ithuan.tw}
      LETSENCRYPT_HOST: ${VIRTUAL_HOST_AUTUAN:-dbkaxabu.ithuan.tw}
      LETSENCRYPT_EMAIL: "ithuan@ithuan.tw"
    restart: always

networks:
  nginx-bridge:
    external: true
